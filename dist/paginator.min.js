!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Paginator=t()}(this,(function(){"use strict";var e=Object.freeze({__proto__:null,reportError:function(...e){console.error(...e)},throwError:function(e){throw new Error(e)}});function t(e,t,n){if("string"!=typeof e)return e;let s=document;return null===t&&n?s=n:t&&t instanceof Node&&"querySelector"in t?s=t:n&&n instanceof Node&&"querySelector"in n&&(s=n),"all"===t?s.querySelectorAll(e):s.querySelector(e)}function n(e,t,n=1/0,s=!1){let a=e.parentElement,i=0;for(;a&&i<n;){if(a.matches(t))return!s||a;a=a.parentElement,i++}return!!s&&null}function s(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function a(e){return"function"==typeof e}function i(e){return"string"==typeof e}function o(e){return Array.isArray(e)}function r(e){return"number"!=typeof e&&(!e||"string"==typeof e&&0===e.length)}function l(e,...t){if(!t.length)return e;const n=t.shift();if(n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const a=n[t],i=t;s(a)||o(a)?(e[i]&&"object"==typeof e[i]||(e[i]=Array.isArray(a)?[]:{}),l(e[i],a)):e[i]=a}return l(e,...t)}function c(e=8){return Math.random().toString(36).substring(2,2+e)}function u(e,t=new FormData){const{data:n,parentKey:s=""}=e;if(null!==n&&"object"==typeof n)if(n instanceof Blob||n instanceof File){const e=s||"file";t.append(e,n)}else Object.keys(n).forEach((e=>{const a=n[e],i=s?`${s}[${e}]`:e;null!==a&&"object"==typeof a?u({data:a,parentKey:i},t):null!==a&&t.append(i,String(a))}));else null!==n&&t.append(s,n);return t}function h(e,t=""){if(e instanceof FormData)return e;return u({data:e,parentKey:t})}async function _(e){const{url:t,method:n="GET",headers:s={},cache:a="no-cache",mode:i="cors",credentials:o="same-origin",body:r=null,beforeSend:l=null,success:c=null,error:u=null}=e;let h,_=t,p={method:n,mode:i,headers:s instanceof Headers?s:new Headers(s),cache:a,credentials:o};if(null!==r&&"GET"===n.toUpperCase())_=function(e,t,n=!0){const s=new URL(e);for(const[e,a]of Object.entries(t)){const t=null===a?"":String(a);!n&&s.searchParams.has(e)||s.searchParams.set(e,t)}return s.toString()}("string"==typeof t?t:t.toString(),r,!0);else if(null!==r&&["PUT","POST","DELETE"].includes(n.toUpperCase())){let e=r;r instanceof FormData||(e=JSON.stringify(r),p.headers instanceof Headers||(p.headers=new Headers(p.headers)),p.headers.append("Content-Type","application/json")),p.body=e}if("string"==typeof _||_ instanceof URL)h=new Request(_,p);else{if(!(_ instanceof Request))throw new Error("Invalid URL type");h=_}try{const e=await new Promise((e=>{l?.(),e(h)})),t=await fetch(e),n=await t.json();return c?.(n),n}catch(e){throw u?.(e),e}}async function p(e){const{url:t,data:n,method:s="POST",headers:a,cache:i,mode:o,credentials:r,success:l,errorCallback:c,beforeSend:u,encode:p=!0}=e;return _({url:t,method:s,headers:a,cache:i,mode:o,credentials:r,body:p&&"GET"!==s.toUpperCase()?h(n):n,beforeSend:u,success:e=>{l?.(e)},error:e=>{c?.(e)}})}async function f(e){const{url:t,data:n,method:s="POST",headers:a,cache:i,mode:o,credentials:r,success:l,errorCallback:c,beforeSend:u}=e;return _({url:t,method:s,headers:a,cache:i,mode:o,credentials:r,body:h(n),beforeSend:u,success:e=>{l?.(e)},error:e=>{c?.(e)}}).then((()=>!0)).catch((()=>!1))}const d=p,g=f;var m=Object.freeze({__proto__:null,doFetch:_,fetchData:d,sendData:p,sendForm:g,sendFormData:f});class y{static throwError=e.throwError;static getElem=t;static hasParent=n;static deepMerge=l;static generateRandom=c;static isEmpty=r;static isObject=s;static isArray=o;static isString=i;static isFunction=a;static fetchData=m.fetchData;static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static composeClassNames(...e){return(e=e.filter((e=>!!e))).length>0?e.join(" "):""}static isPageItem(e){const t=["J-pagination-page","J-pagination-previous","J-pagination-next"],n=e.classList;for(let e=0;e<t.length;e++)if(n.contains(t[e]))return!0;return!1}}const b={dataSource:[],locator:"data",totalNumber:0,totalNumberLocator:null,pageNumber:1,pageSize:10,pageRange:2,alias:{pageNumber:"pageNumber",pageSize:"pageSize"},showPrevious:!0,showNext:!0,showPageNumbers:!0,showNavigator:!1,hideFirstOnEllipsisShow:!1,hideLastOnEllipsisShow:!1,autoHidePrevious:!1,autoHideNext:!1,classPrefix:"pagination",className:"",activeClassName:"active",disableClassName:"disabled",ulClassName:"",pageClassName:"",prevClassName:"",nextClassName:"",prevText:"&laquo;",nextText:"&raquo;",ellipsisText:"...",goButtonText:"Go",formatNavigator:"{currentPage} of {totalPage}",header:"",footer:"",pageLink:"",position:"bottom",formatResult:e=>e,dataLoader:{method:"GET",data:{},cache:"no-cache",headers:{"Content-Type":"application/json"},mode:"cors",beforeSend:e=>e,credentials:"same-origin",pageNumberStartWithZero:!1},triggerPagingOnInit:!0,resetPageNumberOnInit:!1,hideOnlyOnePage:!1,onError:e=>console.error("Pagination error:",e)};var v,P,N,S,w,k,T,D,L,C,x={},E=[],M=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,O=Array.isArray;function I(e,t){for(var n in t)e[n]=t[n];return e}function F(e){var t=e.parentNode;t&&t.removeChild(e)}function H(e,t,n){var s,a,i,o={};for(i in t)"key"==i?s=t[i]:"ref"==i?a=t[i]:o[i]=t[i];if(arguments.length>2&&(o.children=arguments.length>3?v.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===o[i]&&(o[i]=e.defaultProps[i]);return A(e,o,s,a,null)}function A(e,t,n,s,a){var i={type:e,props:t,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==a?++N:a,__i:-1,__u:0};return null==a&&null!=P.vnode&&P.vnode(i),i}function R(e){return e.children}function $(e,t){this.props=e,this.context=t}function U(e,t){if(null==t)return e.__?U(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?U(e):null}function J(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return J(e)}}function j(e){(!e.__d&&(e.__d=!0)&&S.push(e)&&!z.__r++||w!==P.debounceRendering)&&((w=P.debounceRendering)||k)(z)}function z(){var e,t,n,s,a,i,o,r;for(S.sort(T);e=S.shift();)e.__d&&(t=S.length,s=void 0,i=(a=(n=e).__v).__e,o=[],r=[],n.__P&&((s=I({},a)).__v=a.__v+1,P.vnode&&P.vnode(s),Q(n.__P,s,a,n.__n,n.__P.namespaceURI,32&a.__u?[i]:null,o,null==i?U(a):i,!!(32&a.__u),r),s.__v=a.__v,s.__.__k[s.__i]=s,X(o,s,r),s.__e!=i&&J(s)),S.length>t&&S.sort(T));z.__r=0}function W(e,t,n,s,a,i,o,r,l,c,u){var h,_,p,f,d,g=s&&s.__k||E,m=t.length;for(n.__d=l,B(n,t,g),l=n.__d,h=0;h<m;h++)null!=(p=n.__k[h])&&"boolean"!=typeof p&&"function"!=typeof p&&(_=-1===p.__i?x:g[p.__i]||x,p.__i=h,Q(e,p,_,a,i,o,r,l,c,u),f=p.__e,p.ref&&_.ref!=p.ref&&(_.ref&&ee(_.ref,null,p),u.push(p.ref,p.__c||f,p)),null==d&&null!=f&&(d=f),65536&p.__u||_.__k===p.__k?(l&&!l.isConnected&&(l=U(_)),l=q(p,l,e)):"function"==typeof p.type&&void 0!==p.__d?l=p.__d:f&&(l=f.nextSibling),p.__d=void 0,p.__u&=-196609);n.__d=l,n.__e=d}function B(e,t,n){var s,a,i,o,r,l=t.length,c=n.length,u=c,h=0;for(e.__k=[],s=0;s<l;s++)o=s+h,null!=(a=e.__k[s]=null==(a=t[s])||"boolean"==typeof a||"function"==typeof a?null:"string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?A(null,a,null,null,null):O(a)?A(R,{children:a},null,null,null):void 0===a.constructor&&a.__b>0?A(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a)?(a.__=e,a.__b=e.__b+1,r=G(a,n,o,u),a.__i=r,i=null,-1!==r&&(u--,(i=n[r])&&(i.__u|=131072)),null==i||null===i.__v?(-1==r&&h--,"function"!=typeof a.type&&(a.__u|=65536)):r!==o&&(r===o+1?h++:r>o?u>l-o?h+=r-o:h--:r<o?r==o-1&&(h=r-o):h=0,r!==s+h&&(a.__u|=65536))):(i=n[o])&&null==i.key&&i.__e&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=U(i)),te(i,i,!1),n[o]=null,u--);if(u)for(s=0;s<c;s++)null!=(i=n[s])&&!(131072&i.__u)&&(i.__e==e.__d&&(e.__d=U(i)),te(i,i))}function q(e,t,n){var s,a;if("function"==typeof e.type){for(s=e.__k,a=0;s&&a<s.length;a++)s[a]&&(s[a].__=e,t=q(s[a],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function G(e,t,n,s){var a=e.key,i=e.type,o=n-1,r=n+1,l=t[n];if(null===l||l&&a==l.key&&i===l.type&&!(131072&l.__u))return n;if(s>(null==l||131072&l.__u?0:1))for(;o>=0||r<t.length;){if(o>=0){if((l=t[o])&&!(131072&l.__u)&&a==l.key&&i===l.type)return o;o--}if(r<t.length){if((l=t[r])&&!(131072&l.__u)&&a==l.key&&i===l.type)return r;r++}}return-1}function V(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||M.test(t)?n:n+"px"}function K(e,t,n,s,a){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof s&&(e.style.cssText=s=""),s)for(t in s)n&&t in n||V(e.style,t,"");if(n)for(t in n)s&&n[t]===s[t]||V(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?s?n.u=s.u:(n.u=D,e.addEventListener(t,i?C:L,i)):e.removeEventListener(t,i?C:L,i);else{if("http://www.w3.org/2000/svg"==a)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function Z(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=D++;else if(t.t<n.u)return;return n(P.event?P.event(t):t)}}}function Q(e,t,n,s,a,i,o,r,l,c){var u,h,_,p,f,d,g,m,y,b,v,N,S,w,k,T=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(l=!!(32&n.__u),i=[r=t.__e=n.__e]),(u=P.__b)&&u(t);e:if("function"==typeof T)try{if(m=t.props,y=(u=T.contextType)&&s[u.__c],b=u?y?y.props.value:u.__:s,n.__c?g=(h=t.__c=n.__c).__=h.__E:("prototype"in T&&T.prototype.render?t.__c=h=new T(m,b):(t.__c=h=new $(m,b),h.constructor=T,h.render=ne),y&&y.sub(h),h.props=m,h.state||(h.state={}),h.context=b,h.__n=s,_=h.__d=!0,h.__h=[],h._sb=[]),null==h.__s&&(h.__s=h.state),null!=T.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=I({},h.__s)),I(h.__s,T.getDerivedStateFromProps(m,h.__s))),p=h.props,f=h.state,h.__v=t,_)null==T.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==T.getDerivedStateFromProps&&m!==p&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,b),!h.__e&&(null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,b)||t.__v===n.__v)){for(t.__v!==n.__v&&(h.props=m,h.state=h.__s,h.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),v=0;v<h._sb.length;v++)h.__h.push(h._sb[v]);h._sb=[],h.__h.length&&o.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,b),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(p,f,d)}))}if(h.context=b,h.props=m,h.__P=e,h.__e=!1,N=P.__r,S=0,"prototype"in T&&T.prototype.render){for(h.state=h.__s,h.__d=!1,N&&N(t),u=h.render(h.props,h.state,h.context),w=0;w<h._sb.length;w++)h.__h.push(h._sb[w]);h._sb=[]}else do{h.__d=!1,N&&N(t),u=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++S<25);h.state=h.__s,null!=h.getChildContext&&(s=I(I({},s),h.getChildContext())),_||null==h.getSnapshotBeforeUpdate||(d=h.getSnapshotBeforeUpdate(p,f)),W(e,O(k=null!=u&&u.type===R&&null==u.key?u.props.children:u)?k:[k],t,n,s,a,i,o,r,l,c),h.base=t.__e,t.__u&=-161,h.__h.length&&o.push(h),g&&(h.__E=h.__=null)}catch(e){t.__v=null,l||null!=i?(t.__e=r,t.__u|=l?160:32,i[i.indexOf(r)]=null):(t.__e=n.__e,t.__k=n.__k),P.__e(e,t,n)}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Y(n.__e,t,n,s,a,i,o,l,c);(u=P.diffed)&&u(t)}function X(e,t,n){t.__d=void 0;for(var s=0;s<n.length;s++)ee(n[s],n[++s],n[++s]);P.__c&&P.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){P.__e(e,t.__v)}}))}function Y(e,t,n,s,a,i,o,r,l){var c,u,h,_,p,f,d,g=n.props,m=t.props,y=t.type;if("svg"===y?a="http://www.w3.org/2000/svg":"math"===y?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),null!=i)for(c=0;c<i.length;c++)if((p=i[c])&&"setAttribute"in p==!!y&&(y?p.localName===y:3===p.nodeType)){e=p,i[c]=null;break}if(null==e){if(null===y)return document.createTextNode(m);e=document.createElementNS(a,y,m.is&&m),i=null,r=!1}if(null===y)g===m||r&&e.data===m||(e.data=m);else{if(i=i&&v.call(e.childNodes),g=n.props||x,!r&&null!=i)for(g={},c=0;c<e.attributes.length;c++)g[(p=e.attributes[c]).name]=p.value;for(c in g)if(p=g[c],"children"==c);else if("dangerouslySetInnerHTML"==c)h=p;else if("key"!==c&&!(c in m)){if("value"==c&&"defaultValue"in m||"checked"==c&&"defaultChecked"in m)continue;K(e,c,null,p,a)}for(c in m)p=m[c],"children"==c?_=p:"dangerouslySetInnerHTML"==c?u=p:"value"==c?f=p:"checked"==c?d=p:"key"===c||r&&"function"!=typeof p||g[c]===p||K(e,c,p,g[c],a);if(u)r||h&&(u.__html===h.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(h&&(e.innerHTML=""),W(e,O(_)?_:[_],t,n,s,"foreignObject"===y?"http://www.w3.org/1999/xhtml":a,i,o,i?i[0]:n.__k&&U(n,0),r,l),null!=i)for(c=i.length;c--;)null!=i[c]&&F(i[c]);r||(c="value",void 0!==f&&(f!==e[c]||"progress"===y&&!f||"option"===y&&f!==g[c])&&K(e,c,f,g[c],a),c="checked",void 0!==d&&d!==e[c]&&K(e,c,d,g[c],a))}return e}function ee(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){P.__e(e,n)}}function te(e,t,n){var s,a;if(P.unmount&&P.unmount(e),(s=e.ref)&&(s.current&&s.current!==e.__e||ee(s,null,t)),null!=(s=e.__c)){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(e){P.__e(e,t)}s.base=s.__P=null}if(s=e.__k)for(a=0;a<s.length;a++)s[a]&&te(s[a],t,n||"function"!=typeof e.type);n||null==e.__e||F(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function ne(e,t,n){return this.constructor(e,n)}v=E.slice,P={__e:function(e,t,n,s){for(var a,i,o;t=t.__;)if((a=t.__c)&&!a.__)try{if((i=a.constructor)&&null!=i.getDerivedStateFromError&&(a.setState(i.getDerivedStateFromError(e)),o=a.__d),null!=a.componentDidCatch&&(a.componentDidCatch(e,s||{}),o=a.__d),o)return a.__E=a}catch(t){e=t}throw e}},N=0,$.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=I({},this.state),"function"==typeof e&&(e=e(I({},n),this.props)),e&&I(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),j(this))},$.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),j(this))},$.prototype.render=R,S=[],k="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,T=function(e,t){return e.__v.__b-t.__v.__b},z.__r=0,D=0,L=Z(!1),C=Z(!0);class se{callbacks={};init(e){e&&!this.callbacks[e]&&(this.callbacks[e]=[])}listeners(){return this.callbacks}addListener(e,t){return this.on(e,t)}on(e,t){return this.init(e),this.callbacks[e].push(t),this}off(e,t){const n=e;return this.init(),this.callbacks[n]&&0!==this.callbacks[n].length?(this.callbacks[n]=this.callbacks[n].filter((e=>e!=t)),this):this}async emit(e,...t){const n=e;return this.init(n),this.callbacks[n].length>0&&(await Promise.all(this.callbacks[n].map((async e=>await e(...t)))),!0)}once(e,t){const n=async(...s)=>{await t(...s),this.off(e,n)};return this.on(e,n)}}class ae extends se{static version="1.0.4";static instances=[];static firstLoad=!0;instanceID;options=b;pageData={isAsync:!1,direction:0,currentPage:0,totalNumber:0,totalPage:0};container=null;element=null;disabled=!1;isDynamicTotalNumber=!1;constructor(e,t){return super(),this.instanceID=y.generateRandom(6),this.container=y.isString(e)?y.getElem(e):e,this.initialize(t).then((e=>{this.bindEvents(),this.observer(),this.emit("afterInit",e),this.initPageTrigger()})),ae.instances.push(this),1===ae.instances.length&&!0===ae.firstLoad&&console.log(`Paginator is loaded, version: ${ae.version}`),ae.firstLoad=!1,this}async initialize(e){this.options=y.deepMerge({},b,e);const t=await this.parseDataSource(this.options.dataSource);this.pageData.isAsync=y.isString(t),this.pageData.totalNumber=y.isArray(t)?t.length:0,this.isDynamicTotalNumber=y.isFunction(this.options.totalNumberLocator)&&this.pageData.isAsync;const n=this.renderHTML(!0);return this.options.className&&n.classList.add(this.options.className),n}async parseDataSource(e){return new Promise(((t,n)=>{if(y.isObject(e))t(this.options.dataSource=this.filterDataWithLocator(e));else if(y.isArray(e))t(this.options.dataSource=e);else if(y.isFunction(e)){if(!y.isFunction(this.options.dataSource))return void n('The type of "dataSource" is a Function, but "options.dataSource" is not a Function.');this.options.dataSource((e=>{y.isArray(e)||n('The parameter of "done" Function should be an Array.'),this.parseDataSource(e).then(t).catch(n)}))}else y.isString(e)?(/^https?|file:/.test(e)||(e=(e=new URL(e,window.location.href)).toString()),t(e)):n("Unexpected dataSource type")}))}async initPageTrigger(){let e=this.pageData.currentPage||this.options.pageNumber;this.element&&(this.isDynamicTotalNumber&&this.options.resetPageNumberOnInit&&(e=1),this.options.triggerPagingOnInit&&this.emit("go",Math.min(e,Math.max(this.getTotalPage(),1))))}renderHTML(e=!1){const t=this.options,n=this.getTotalPage();if(e){const e=document.createElement("div");e.className="paginator",e.dataset.instanceId=this.instanceID,t.className&&e.classList.add(t.className),this.container&&("bottom"===t.position?this.container.appendChild(e):this.container.insertBefore(e,this.container.firstChild)),this.element=e}const s=this.element;this.emit("beforeRender",!0!==e);const a=this.pageData.currentPage||t.pageNumber,i=t.pageRange||0;let o=a-i,r=a+i;r>n&&(r=n,o=n-2*i,o=o<1?1:o),o<=1&&(o=1,r=Math.min(2*i+1,n));return function(e,t,n){var s,a,i,o;P.__&&P.__(e,t),a=(s="function"==typeof n)?null:t.__k,i=[],o=[],Q(t,e=(!s&&n||t).__k=H(R,null,[e]),a||x,x,t.namespaceURI,!s&&n?[n]:a?null:t.firstChild?v.call(t.childNodes):null,i,!s&&n?n:a?a.__e:t.firstChild,s,o),X(i,e,o)}(this.generateHTML(a,o,r),s),t.hideOnlyOnePage&&n<=1?this.element.style.display="none":this.element.style.display="",this.emit("afterRender",!0!==e),s}renderData(e,t,n){if(this.emit("beforePaging",t),this.pageData.direction=t>this.pageData.currentPage?1:-1,this.pageData.currentPage=t,this.renderHTML(),this.disabled&&this.pageData.isAsync&&this.enable(),"function"==typeof this.options.formatResult){let t=y.deepMerge([],e);y.isArray(e=this.options.formatResult(t))||(e=t)}this.doCallback(e,n),this.emit("afterPaging",t),1===t?this.emit("afterIsFirstPage"):t===this.getTotalPage()&&this.emit("afterIsLastPage")}doCallback(e,t){"function"==typeof t?t(e,this.pageData):"function"==typeof this.options.callback&&this.options.callback(e,this)}observer(){const e=this.element;e&&e.addEventListener("click",(async e=>{let t=e.target;if(!y.isPageItem(t)){const e=y.hasParent(t,"li",5,!0);if(!e)return;t=e}const n=t.getAttribute("data-num");if(t.classList.contains("J-paginator-page")&&n&&(this.emit("beforePageOnClick",e,n),this.emit("go",parseInt(n,10)),this.emit("afterPageOnClick",e,n)),t.classList.contains("J-paginator-previous")&&n&&(this.emit("beforePreviousOnClick",e,n),this.emit("go",parseInt(n,10)),this.emit("afterPreviousOnClick",e,n)),t.classList.contains("J-paginator-next")&&n&&(this.emit("beforeNextOnClick",e,n),this.emit("go",parseInt(n,10)),this.emit("afterNextOnClick",e,n)),t.classList.contains("J-paginator-go-button")){const t=y.getElem(".J-paginator-go-pagenumber");if(!t)return;const n=t.value;this.emit("beforeGoButtonOnClick",e,n),this.emit("go",parseInt(n,10)),this.emit("afterGoButtonOnClick",e,n)}if(t.classList.contains("J-paginator-size-select")){const n=parseInt(t.value,10),s=this.pageData.currentPage||this.options.pageNumber;this.emit("beforeSizeSelectorChange",e,n),this.options.pageSize=n,this.pageData.currentPage=n,this.pageData.totalPage=this.getTotalPage(),s>this.pageData.totalPage&&(this.pageData.currentPage=this.pageData.totalPage),this.emit("go",this.pageData.currentPage),this.emit("afterSizeSelectorChange",e,n)}}))}getPagingData(e){const t=this.options.dataSource,n=this.options.pageSize||0,s=this.getTotalNumber(),a=n*(e-1)+1,i=Math.min(e*n,s);return y.isArray(t)?t.slice(a-1,i):[]}getTotalNumber(){return this.pageData.totalNumber||this.options.totalNumber||0}getTotalPage(){const e=this.options.pageSize||0;return Math.ceil(this.getTotalNumber()/e)}getLocator(e){let t;return"string"==typeof e?t=e:"function"==typeof e?t=e():y.throwError('"locator" is incorrect. Expect string or function type.'),t}filterDataWithLocator(e){const t=this.getLocator(this.options.locator);let n=e;if(y.isString(t)||y.throwError("locator is incorrect. Expect string type."),y.isObject(e))try{t.split(".").forEach((e=>{n=n[e]})),y.isArray(n)||y.throwError("dataSource."+t+" should be an Array.")}catch(e){y.throwError(`Error accessing dataSource.${t}: ${e}`)}return n}bindEvents(){this.on("go",(async(e,t)=>await this.go(e,t))),this.on("previous",(async e=>await this.previous(e))),this.on("next",(async e=>await this.next(e))),this.on("disable",(()=>this.disable())),this.on("enable",(()=>this.enable())),this.on("show",(()=>this.show())),this.on("hide",(()=>this.hide())),this.on("destroy",(()=>this.destroy()))}unbindEvents(){this.off("go",(async(e,t)=>await this.go(e,t))),this.off("previous",(async e=>await this.previous(e))),this.off("next",(async e=>await this.next(e))),this.off("disable",(()=>this.disable())),this.off("enable",(()=>this.enable())),this.off("show",(()=>this.show())),this.off("hide",(()=>this.hide())),this.off("destroy",(()=>this.destroy()))}getPageLinkTag(e){const t=this.options.pageLink;return H("a",t?{href:t}:null,e)}generatePageNumbersHTML(e){const t=this.options,n=e.currentPage,s=this.getTotalPage(),a=e.rangeStart,i=e.rangeEnd,o=this.getPageLinkTag.bind(this),r=t.ellipsisText,l=t.classPrefix,c=t.pageClassName||"",u=t.activeClassName||"",h=t.disableClassName||"",_=[];if(null===t.pageRange){for(let e=1;e<=s;e++)_.push(H("li",{class:y.composeClassNames(`${l}-page`,"J-paginator-page",c,e===n?u:""),"data-num":e.toString()},o(e)));return _}if(a<=3)for(let e=1;e<a;e++)_.push(H("li",{class:y.composeClassNames(`${l}-page`,"J-paginator-page",c,e===n?u:""),"data-num":e.toString()},o(e)));else t.hideFirstOnEllipsisShow||_.push(H("li",{class:y.composeClassNames(`${l}-page`,`${l}-first`,"J-paginator-page",c),"data-num":"1"},o(1))),_.push(H("li",{class:y.composeClassNames(`${l}-ellipsis`,h)},H("a",{dangerouslySetInnerHTML:{__html:r}})));for(let e=a;e<=i;e++)_.push(H("li",{class:y.composeClassNames(`${l}-page`,"J-paginator-page",c,e===n?u:""),"data-num":e.toString()},o(e)));if(i>=s-2)for(let e=i+1;e<=s;e++)_.push(H("li",{class:y.composeClassNames(`${l}-page`,"J-paginator-page",c),"data-num":e.toString()},o(e)));else _.push(H("li",{class:y.composeClassNames(`${l}-ellipsis`,h)},H("a",{dangerouslySetInnerHTML:{__html:r}}))),t.hideLastOnEllipsisShow||_.push(H("li",{class:y.composeClassNames(`${l}-page`,`${l}-last`,"J-paginator-page",c),"data-num":s.toString()},o(s)));return _}generateHTML(e,t,n){const s=this.options,a=this.getTotalPage(),i=this.getTotalNumber(),o=s.pageSize||0,r=s.prevText,l=s.nextText,c=s.classPrefix||"",u=s.disableClassName||"",h=s.ulClassName||"",_=s.prevClassName||"",p=s.nextClassName||"",f="function"==typeof s.formatNavigator?s.formatNavigator(e,a,i):s.formatNavigator,d=s.autoHidePrevious??!1,g=s.autoHideNext??!1,m="function"==typeof s.header?s.header(e,a,i):s.header,b="function"==typeof s.footer?s.footer(e,a,i):s.footer,v=[];s.showPrevious&&(e<=1?d||v.push(H("li",{class:y.composeClassNames(`${c}-prev`,u,_)},H("a",{dangerouslySetInnerHTML:{__html:r}}))):v.push(H("li",{class:y.composeClassNames(`${c}-prev`,"J-paginator-previous",_),"data-num":e-1,title:"Previous page"},H("a",{dangerouslySetInnerHTML:{__html:r}})))),s.showPageNumbers&&v.push(...this.generatePageNumbersHTML({currentPage:e,rangeStart:t,rangeEnd:n})),s.showNext&&(e>=a?g||v.push(H("li",{class:y.composeClassNames(`${c}-next`,u,p)},H("a",{dangerouslySetInnerHTML:{__html:l}}))):v.push(H("li",{class:y.composeClassNames(`${c}-next`,"J-paginator-next",p),"data-num":e+1,title:"Next page"},H("a",{dangerouslySetInnerHTML:{__html:l}}))));const P=[m&&H("div",{class:"paginator-header",dangerouslySetInnerHTML:{__html:this.replaceVariables(m,{currentPage:e,totalPage:a,totalNumber:i})}}),s.showNavigator&&f&&H("div",{class:y.composeClassNames(`${c}-nav J-paginator-nav`),dangerouslySetInnerHTML:{__html:this.replaceVariables(f,{currentPage:e,totalPage:a,totalNumber:i,rangeStart:(e-1)*o+1,rangeEnd:Math.min(e*o,i)})}}),H("div",{class:"paginator-pages"},H("ul",{class:h},...v)),b&&H("div",{class:"paginator-footer",dangerouslySetInnerHTML:{__html:this.replaceVariables(b,{currentPage:e,totalPage:a,totalNumber:i})}})].filter(Boolean);return H("div",{class:"paginator-container"},...P)}findTotalNumberFromRemoteResponse(e){let t=0;y.isFunction(this.options.totalNumberLocator)&&(t=this.options.totalNumberLocator(e),y.isNumeric(t)||y.throwError("totalNumberLocator should return a number."),this.pageData.totalNumber=t)}async go(e,t){if(this.disabled||!this.element)return;if(!(e=parseInt(e,10))||e<1)return;const n=this.options.pageSize,s=this.getTotalNumber(),a=this.getTotalPage();if(s>0&&e>a)return;if(!this.pageData.isAsync)return void this.renderData(this.getPagingData(e),e,t);const i={},o=this.options.alias||{},r=o.pageSize||"pageSize",l=o.pageNumber||"pageNumber";i[r]=n,i[l]=e;const c=y.isFunction(this.options.dataLoader)?this.options.dataLoader():this.options.dataLoader;c&&c.pageNumberStartWithZero&&(i[l]=e-1);const u={url:this.options.dataSource,method:c?.method,data:c?.data?"function"==typeof c.data?await c.data(c):y.deepMerge({},c?.data,i):i,headers:c?.headers,mode:c?.mode,cache:c?.cache,credentials:c?.credentials||"same-origin",beforeSend:()=>{this.disable(),c?.beforeSend&&c.beforeSend(c)},success:n=>{this.isDynamicTotalNumber?this.findTotalNumberFromRemoteResponse(n):this.pageData.totalNumber=this.options.totalNumber;const s=this.filterDataWithLocator(n);this.renderData(s,e,t),this.enable()},errorCallback:e=>{if("function"!=typeof this.options.onError)throw e;this.options.onError(e),this.enable()}};y.isFunction(this.options.dataLoaderFunction)?this.options.dataLoaderFunction(this):await y.fetchData(u)}destroy(){this.emit("beforeDestroy"),this.element&&(this.element.remove(),this.element=null),this.container&&(this.container.innerHTML=""),this.unbindEvents(),ae.instances=ae.instances.filter((e=>e!==this)),this.emit("afterDestroy")}async previous(e){this.pageData.currentPage>1&&this.emit("go",this.pageData.currentPage-1,e)}async next(e){this.pageData.currentPage<this.getTotalPage()&&this.emit("go",this.pageData.currentPage+1,e)}disable(){const e=this.pageData.isAsync?"async":"sync";this.emit("beforeDisable",e),this.disabled=!0,this.emit("afterDisable",e)}enable(){const e=this.pageData.isAsync?"async":"sync";this.emit("beforeEnable",e),this.disabled=!1,this.emit("afterEnable",e)}show(){this.element&&"none"===this.element.style.display&&(this.element.style.display="")}hide(){this.element&&"none"!==this.element.style.display&&(this.element.style.display="none")}replaceVariables(e,t){let n=e;for(const e in t){const s=t[e],a=new RegExp(`<%=\\s*${e}\\s*%>`,"img");n=n.replace(a,s)}return n}get version(){return ae.version}}return ae}));
